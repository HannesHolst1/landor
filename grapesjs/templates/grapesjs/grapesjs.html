<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>GrapesJS Preset Webpage</title>
    <link href="https://unpkg.com/grapesjs/dist/css/grapes.min.css" rel="stylesheet">
    <link href="/static/assets/plugins/grapejs/css/grapesjs-preset-webpage.min.css" rel="stylesheet">
    <!--<script src="//feather.aviary.com/imaging/v3/editor.js"></script>-->
    <script src="https://static.filestackapi.com/v3/filestack-0.1.10.js"></script>
    <script src="https://unpkg.com/grapesjs"></script>
    <script src="/static/assets/plugins/grapejs/js/grapesjs-preset-webpage.min.js"></script>
    <style>
      body,
      html {
        height: 100%;
        margin: 0;
      }
    </style>
  </head>
  <body>

    <div id="gjs"></div>


    <script type="text/javascript">
      var editor = grapesjs.init({
        height: '100%',
        showOffsets: 1,
        noticeOnUnload: 0,
        storageManager: { 
          type: 'remote',
          // stepsBeforeSave: 1,
          autosave: false,
          autoload: true,
          storeComponents: true,
          storeStyles: true,
          storeHtml: true,
          storeCss: true,	
          urlStore: '/grapesjs/save/',
          urlLoad: '/grapesjs/load/',
          headers: { "X-CSRFToken": '{{ csrf }}',
                    "GjsContent-Version": '{{ version }}'
                   }
		    },
        container: '#gjs',
        fromElement: true,
        styleManager: {
          clearProperties: true,
        },		

        plugins: ['gjs-preset-webpage'],
        pluginsOpts: {
          'gjs-preset-webpage': {}
        }
      });
	  
	  editor.Panels.addButton('options', 
			[ 
				{ 
					id: 'save', 
					className: 'fa fa-floppy-o icon-blank', 
					command: function(editor1, sender) 
					{ editor.store(res => console.log('Store callback')); }, 
					attributes: { title: 'Save Template' } 
				}, 
			]
		);
    </script>
  </body>
</html>
